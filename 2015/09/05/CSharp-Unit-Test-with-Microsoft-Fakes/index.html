<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="google-site-verification" content="D_sz64DZ1b38eNfy3sac0h9jaE2HKjSg0qeS_6Ar_aw">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"winterttr.me","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"b2t":false,"scrollpercent":true},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="In common C# Unit test, we always meet the problem that our final application is depending on many 3rd party or system references. But for unit test, we need to separate and control the dependency lib">
<meta property="og:type" content="article">
<meta property="og:title" content="C# Unit Test with Microsoft Fakes">
<meta property="og:url" content="http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/index.html">
<meta property="og:site_name" content="Life &amp; Note">
<meta property="og:description" content="In common C# Unit test, we always meet the problem that our final application is depending on many 3rd party or system references. But for unit test, we need to separate and control the dependency lib">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/stub-shim-concept-diagram.jpg">
<meta property="og:image" content="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/add-fakes-assembly.jpg">
<meta property="og:image" content="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/after-add-fake.jpg">
<meta property="article:published_time" content="2015-09-05T10:43:17.000Z">
<meta property="article:modified_time" content="2023-01-23T07:17:43.152Z">
<meta property="article:author" content="winterTTr">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="Unit Test">
<meta property="article:tag" content="Fake">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/stub-shim-concept-diagram.jpg">

<link rel="canonical" href="http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>C# Unit Test with Microsoft Fakes | Life & Note</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?12217b6eff7690192f4e4469013eee76";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Life & Note" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Life & Note</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">winterTTr Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">23</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">65</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="winterTTr">
      <meta itemprop="description" content="Memo down pieces of Life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Life & Note">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          C# Unit Test with Microsoft Fakes
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-09-05 10:43:17" itemprop="dateCreated datePublished" datetime="2015-09-05T10:43:17+00:00">2015-09-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C#</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>931</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>3 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>In common C# Unit test, we always meet the problem that our final application is depending on many 3rd party or system references. But for unit test, we need to separate and control the dependency libraries behaviour. One of the solution will be <code>Microsoft Fake</code>.</p>
<p>Here let me talk about Microsoft Fake , and how to unit test your application which depends on many system or other references.</p>
<span id="more"></span>


<h2 id="Microsoft-Fake"><a href="#Microsoft-Fake" class="headerlink" title="Microsoft Fake"></a>Microsoft Fake</h2><p><strong>Microsoft Fakes</strong> is a test framework help you isolate the code you are testing by replacing other parts of the application.<br><strong>Microsoft Fake</strong> is highly integrated with Visual Studio and you can easily start to use it with very several clicks.</p>
<p>Fakes come in two flavours:</p>
<ul>
<li><p>A <code>shim</code> modifies the compiled code of your application at run time so that instead of making a specified method call, it runs the shim code that your test provides. Shims can be used to replace calls to assemblies that you cannot modify, such .NET assemblies.</p>
</li>
<li><p>A <code>stub</code> replaces a class with a small substitute that implements the same interface. To use stubs, you have to design your application so that each component depends only on interfaces, and not on other components.</p>
</li>
</ul>
<p>A good diagram to distinguish those two:<br><img src="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/stub-shim-concept-diagram.jpg" alt="stub-shim-concept-diagram.jpg"></p>
<table>
<thead>
<tr>
<th>Comparison</th>
<th>Shim</th>
<th>Stub</th>
</tr>
</thead>
<tbody><tr>
<td>Performance</td>
<td>Slow ( rewrite code )</td>
<td>As it is ( just interface implementation )</td>
</tr>
<tr>
<td>Static method, seal type</td>
<td>&amp;#10004;</td>
<td>&amp;#x2717;</td>
</tr>
<tr>
<td>Internal Type with InternalsVisibleToAttribute</td>
<td>&amp;#10004;</td>
<td>&amp;#10004;</td>
</tr>
<tr>
<td>Private methods</td>
<td>&amp;#10004; if all the types on the method signature are visible</td>
<td>&amp;#x2717;</td>
</tr>
<tr>
<td>Interfaces and abstract methods</td>
<td>&amp;#x2717;</td>
<td>&amp;#10004;</td>
</tr>
</tbody></table>
<h2 id="Using-Shim"><a href="#Using-Shim" class="headerlink" title="Using Shim"></a>Using Shim</h2><p>Here let we say that we want to test a function in a <code>DemoClassLibrary</code>.</p>
<p>We have a class that implements something depends on <code>System</code> library.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DemoClassLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Foo</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">long</span> <span class="title">UtcNowTick</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> DateTime.UtcNow.Ticks;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So this <code>UtcNowTick</code> is depends on the <code>DateTime</code>, and right now we want to test this function.</p>
<p>This is a typical scenario for us to use <code>shim</code> to test because we cannot control the behaviour of the <code>system</code> library.</p>
<p>First, we add the fake to the library to we want to fake.<br><img src="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/add-fakes-assembly.jpg" alt="add-fakes-assembly.jpg"></p>
<p>After this operation, we can find that we have a fake assembly created:<br><img src="https://winterttrgithubio.blob.core.windows.net/images/2015-09-05-CSharp-Unit-Test-with-Microsoft-Fakes/after-add-fake.jpg" alt="after-add-fake.jpg"></p>
<p>So right now, we have the fake assembly for system now, and we can control the behaviour of system namespace api as below:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> DemoClassLibrary;</span><br><span class="line"><span class="keyword">using</span> Microsoft.QualityTools.Testing.Fakes;</span><br><span class="line"><span class="keyword">using</span> Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ClassLibaryTest</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">TestClass</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestFoo</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestUtcNowTick</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (ShimsContext.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                System.Fakes.ShimDateTime.UtcNowGet = () =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> DateTime.MinValue;</span><br><span class="line">                &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line">                <span class="keyword">var</span> tick = foo.UtcNowTick();</span><br><span class="line"></span><br><span class="line">                Assert.AreEqual(tick,<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As the code show, the fake framework will add an extra code for your faked namespace (such as <code>system</code> in our demo), and all the extra code will under <code>Fakes</code> namespace.<br>We can replace function calls under <code>Fakes</code> namespace to our test implementation expected. Every type will have a <code>Shim+Typename</code> under <code>Fakes</code> for us to replace.</p>
<p>** There is some kinds of different scenarios which we need to test using Shim, here I list some:**</p>
<p>Let’s say that we have a 3rd party library like this:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">DemoDependence</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DependenceClass</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _data;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DependenceClass</span>(<span class="params"><span class="built_in">string</span> data</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _data = data;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">StaticMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DependenceClass::StaticMethod &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">InstanceMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DependenceClass::InstanceMethod &quot;</span> + _data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And we have our application that use this library:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Globalization;</span><br><span class="line"><span class="keyword">using</span> DemoDependence;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DemoClassLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Foo</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">UseDependencyInstanceMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> instance = <span class="keyword">new</span> DependenceClass(</span><br><span class="line">                DateTime.UtcNow.ToString(CultureInfo.CurrentCulture));</span><br><span class="line">            <span class="keyword">return</span> instance.InstanceMethod();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">UseDependencyStaticMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> DependenceClass.StaticMethod();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">UseOneDependencyInstanceMethod</span>(<span class="params">DependenceClass d</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> d.InstanceMethod();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">UseConstructor</span>(<span class="params"><span class="built_in">string</span> d</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> instance = <span class="keyword">new</span> DependenceClass(d);</span><br><span class="line">            <span class="keyword">return</span> instance.InstanceMethod();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>we start our test.</p>
<h3 id="shim-static-function"><a href="#shim-static-function" class="headerlink" title="shim static function"></a>shim static function</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TestMethod</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShimStaticMethod</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (ShimsContext.Create())</span><br><span class="line">    &#123;</span><br><span class="line">        ShimDependenceClass.StaticMethod =</span><br><span class="line">            () =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;my string&quot;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line">        Assert.AreEqual(foo.UseDependencyStaticMethod() , <span class="string">&quot;my string&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<h3 id="shim-instance-function"><a href="#shim-instance-function" class="headerlink" title="shim instance function"></a>shim instance function</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TestMethod</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShimInstanceMethod</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (ShimsContext.Create())</span><br><span class="line">    &#123;</span><br><span class="line">        ShimDependenceClass.AllInstances.InstanceMethod =</span><br><span class="line">            @class =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;my string&quot;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line">        Assert.AreEqual(foo.UseDependencyInstanceMethod(), <span class="string">&quot;my string&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">TestMethod</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShimOneInstanceMethod</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (ShimsContext.Create())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> d = <span class="keyword">new</span> ShimDependenceClass()</span><br><span class="line">        &#123;</span><br><span class="line">            InstanceMethod = () =&gt; &#123; <span class="keyword">return</span> <span class="string">&quot;my string&quot;</span>; &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line">        Assert.AreEqual(foo.UseOneDependencyInstanceMethod(d), <span class="string">&quot;my string&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="shim-constructor"><a href="#shim-constructor" class="headerlink" title="shim constructor"></a>shim constructor</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TestMethod</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShimConstructor</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (ShimsContext.Create())</span><br><span class="line">    &#123;</span><br><span class="line">        ShimDependenceClass.ConstructorString =</span><br><span class="line">            (@this, s) =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> shim = <span class="keyword">new</span> ShimDependenceClass(@this)</span><br><span class="line">                &#123;</span><br><span class="line">                    InstanceMethod = () =&gt; &#123; <span class="keyword">return</span> <span class="string">&quot;my string&quot;</span>; &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line">        Assert.AreEqual(</span><br><span class="line">            foo.UseConstructor(<span class="built_in">string</span>.Empty),</span><br><span class="line">            <span class="string">&quot;my string&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Using-Stub"><a href="#Using-Stub" class="headerlink" title="Using Stub"></a>Using Stub</h2><p>Stum is typically using to implement the interface, let say we have a interface:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDependenceInterface</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">InterfaceMethod</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And our Foo has one more function:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Foo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Hide others</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">UseInterface</span>(<span class="params">IDependenceInterface i</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> i.InterfaceMethod();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The stub would be like this:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">TestMethod</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StubInterface</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="keyword">new</span> StubIDependenceInterface()</span><br><span class="line">    &#123;</span><br><span class="line">        InterfaceMethod = () =&gt; &#123; <span class="keyword">return</span> <span class="string">&quot;my string&quot;</span>; &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line">    Assert.AreEqual(</span><br><span class="line">        foo.UseInterface(i),</span><br><span class="line">        <span class="string">&quot;my string&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Compile-warning-issue"><a href="#Compile-warning-issue" class="headerlink" title="Compile warning issue"></a>Compile warning issue</h2><p>When you use fake the <code>System</code> library, you may see the compilation warning, that is because some type cannot be fakes, you can change the fake configuration file to fixit.<br>The warning is like below:</p>
<blockquote>
<p>Warning 20 Some fakes could not be generated. For complete details, set Diagnostic attribute of the Fakes element in this file to ‘true’ and rebuild the project.</p>
</blockquote>
<p>Just shim or stub the things you really need, here is one of my example in real project:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Fakes</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/fakes/2011/&quot;</span> <span class="attr">Diagnostic</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Assembly</span> <span class="attr">Name</span>=<span class="string">&quot;Microsoft.WindowsAzure.Configuration&quot;</span> <span class="attr">Version</span>=<span class="string">&quot;3.0.0.0&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">StubGeneration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Clear</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">StubGeneration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ShimGeneration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Clear</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Add</span> <span class="attr">FullName</span>=<span class="string">&quot;Microsoft.Azure.CloudConfigurationManager&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ShimGeneration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Compilation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Property</span> <span class="attr">Name</span>=<span class="string">&quot;PlatformTarget&quot;</span>&gt;</span>x64<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Compilation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Fakes</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Other-Options"><a href="#Other-Options" class="headerlink" title="Other Options"></a>Other Options</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Moq/moq4">Moq</a> which is my favourite test framework</li>
</ul>
<hr>
<p><strong>References</strong>:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/hh549175.aspx">Isolating Code Under Test with Microsoft Fakes</a></li>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/hh549176.aspx">Using shims to isolate your application from other assemblies for unit testing</a></li>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/hh549174.aspx">Using stubs to isolate parts of your application from each other for unit testing</a></li>
</ul>
<p>And about markdown:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/712132/in-html-i-can-make-a-checkmark-with-x2713-is-there-a-corresponding-x-mark">Markdown Check and cross character</a></li>
</ul>
<hr>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/weixin.jpg" alt="winterTTr WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="winterTTr Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>winterTTr
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/" title="C# Unit Test with Microsoft Fakes">http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/C/" rel="tag"><i class="fa fa-tag"></i> C#</a>
              <a href="/tags/Unit-Test/" rel="tag"><i class="fa fa-tag"></i> Unit Test</a>
              <a href="/tags/Fake/" rel="tag"><i class="fa fa-tag"></i> Fake</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2015/09/04/binding-new-domain/" rel="prev" title="new domain winterTTr.me">
      <i class="fa fa-chevron-left"></i> new domain winterTTr.me
    </a></div>
      <div class="post-nav-item">
    <a href="/2015/09/05/Concurrent-Reader-on-a-specific-EventHub-Partition-within-one-consumer-group/" rel="next" title="Concurrent Reader on a specific EventHub Partition within one consumer group">
      Concurrent Reader on a specific EventHub Partition within one consumer group <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Microsoft-Fake"><span class="nav-number">1.</span> <span class="nav-text">Microsoft Fake</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-Shim"><span class="nav-number">2.</span> <span class="nav-text">Using Shim</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#shim-static-function"><span class="nav-number">2.1.</span> <span class="nav-text">shim static function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shim-instance-function"><span class="nav-number">2.2.</span> <span class="nav-text">shim instance function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shim-constructor"><span class="nav-number">2.3.</span> <span class="nav-text">shim constructor</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-Stub"><span class="nav-number">3.</span> <span class="nav-text">Using Stub</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Compile-warning-issue"><span class="nav-number">4.</span> <span class="nav-text">Compile warning issue</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Other-Options"><span class="nav-number">5.</span> <span class="nav-text">Other Options</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">winterTTr</p>
  <div class="site-description" itemprop="description">Memo down pieces of Life</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/winterTTr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;winterTTr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:winterTTr@gmail.com" title="E-Mail → mailto:winterTTr@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/winterttr" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;winterttr" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/winterttr" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;winterttr" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/winterttr" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;winterttr" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/winterttr" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;winterttr" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/winterttr" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;winterttr" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/winterttrr" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;winterttrr" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">winterTTr</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">23k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:25</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://winterTTr.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://winterttr.me/2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/";
    this.page.identifier = "2015/09/05/CSharp-Unit-Test-with-Microsoft-Fakes/";
    this.page.title = "C# Unit Test with Microsoft Fakes";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://winterTTr.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
